<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>RV Dump Finder 🗺️ Free, Real-Time Dump Station Map</title>
  <meta name="description" content="Find FREE RV dump stations near you. Real-time status, costs & notes. Updated by RVers. No login. 100% free.">

  <!-- Bootstrap 5 (Free, Mobile-First) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom Styles -->
  <style>
    body { padding-top: 4rem; background: #f8f9fa; }
    .navbar-brand { font-weight: 700; }
    #map { height: 70vh; width: 100%; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
    .submit-card { background: white; border-radius: 12px; padding: 1.5rem; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
    .ad-container { margin: 1.5rem 0; text-align: center; }
    .badge-status { padding: 0.35rem 0.75rem; border-radius: 50px; font-size: 0.85rem; font-weight: 600; }
    .badge-open { background: #28a745; color: white; }
    .badge-closed { background: #dc3545; color: white; }
    footer { background: #2c7be5; color: white; padding: 1.5rem 0; margin-top: 3rem; }
    .hero { background: linear-gradient(135deg, #2c7be5 0%, #0056b3 100%); color: white; padding: 3rem 0; text-align: center; border-radius: 0 0 20px 20px; margin: 0 -1rem 3rem -1rem; }
  </style>
</head>

<body>

  <!-- NAVBAR -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center" href="#">
        <img src="logo.png" alt="RV Dump Finder Logo" class="me-2" style="height: 40px;">
        RV Dump Finder 🗺️
      </a>
      <div class="ms-auto">
        <a href="privacy.html" class="text-white text-decoration-none me-3">Privacy</a>
        <a href="contact.html" class="text-white text-decoration-none">Contact</a>
      </div>
    </div>
  </nav>

  <!-- HERO -->
  <div class="hero">
    <div class="container">
      <h1 class="display-5 fw-bold">Find FREE RV Dump Stations Near You</h1>
      <p class="lead">Real-time status • User-submitted • No login • 100% Free</p>
    </div>
  </div>

  <!-- MAP -->
  <div class="container">
    <div class="ad-container" id="adsense-auto">
      <!-- AdSense Auto Ads will load here -->
    </div>

    <div id="map" class="mb-4"></div>

    <!-- SUBMIT FORM -->
    <div class="submit-card">
      <h3 class="mb-3">📍 Add or Update a Dump Station</h3>
      <p class="text-muted small">Help fellow RVers — submit new spots or update closures.</p>
      <form id="submitForm">
        <div class="mb-3">
          <label class="form-label">📍 Full Address (e.g., Walmart, 123 Main St)</label>
          <input type="text" class="form-control" id="address" placeholder="Walmart, 123 Main St, Anytown" required>
        </div>
        <div class="row mb-3">
          <div class="col-md-6">
            <label class="form-label">🚦 Status</label>
            <select class="form-select" id="status" required>
              <option value="open">✅ Open</option>
              <option value="closed">⛔ Closed</option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label">💰 Cost</label>
            <select class="form-select" id="cost" required>
              <option value="free">🆓 Free</option>
              <option value="$5">$5</option>
              <option value="$10">$10</option>
              <option value="unknown">❓ Unknown</option>
            </select>
          </div>
        </div>
        <div class="mb-3">
          <label class="form-label">📝 Notes (e.g., "Open after 10PM", "Requires receipt")</label>
          <input type="text" class="form-control" id="notes" placeholder="Optional but helpful!">
        </div>
        <button type="submit" class="btn btn-primary w-100">Submit ➡️</button>
      </form>
    </div>

    <!-- TRUST BADGE -->
    <div class="text-center my-4">
      <small class="text-muted">✅ 100% Free • 🔄 Updated by RVers • 🛡️ Spam-Protected</small>
    </div>
  </div>

  <!-- FOOTER -->
  <footer>
    <div class="container text-center">
      <p class="mb-0">RV Dump Finder — Built by RVers, for RVers. © 2025</p>
      <p class="mb-0"><a href="privacy.html" class="text-white">Privacy Policy</a> • <a href="contact.html" class="text-white">Contact</a></p>
    </div>
  </footer>

  <!-- SCRIPTS -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script async src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBS3IIzVsuVdAQHwz6GiiqZPB4uo9gZ7Vw&callback=initMap"></script>

  <script>
    // === REPLACE THIS WITH YOUR FIREBASE CONFIG ===
    const firebaseConfig = {
      apiKey: "AIzaSyCn4OnnJm5Au3ky1XeBeBhLMCsGDe2ULn4",
      authDomain: "rv-dump-finder.firebaseapp.com",
      projectId: "rv-dump-finder",
      storageBucket: "rv-dump-finder.firebasestorage.app",
      messagingSenderId: "701538096167",
      appId: "1:701538096167:web:cf2134e33033cdbaa22a02"
    };
    // ===============================================

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    let map;
    function initMap() {
      map = new google.maps.Map(document.getElementById("map"), {
        center: { lat: 37.7749, lng: -122.4194 },
        zoom: 8,
        styles: [
          { elementType: "geometry", stylers: [{ color: "#ebe3cd" }] },
          { elementType: "labels.text.fill", stylers: [{ color: "#523735" }] },
          { elementType: "labels.text.stroke", stylers: [{ color: "#f5f1e6" }] },
          {
            featureType: "administrative",
            elementType: "geometry.stroke",
            stylers: [{ color: "#c9b2a6" }],
          },
          {
            featureType: "administrative.land_parcel",
            elementType: "geometry.stroke",
            stylers: [{ color: "#dcd2be" }],
          },
          {
            featureType: "administrative.land_parcel",
            elementType: "labels.text.fill",
            stylers: [{ color: "#ae9e90" }],
          },
          {
            featureType: "landscape.natural",
            elementType: "geometry",
            stylers: [{ color: "#dfd2ae" }],
          },
          {
            featureType: "poi",
            elementType: "geometry",
            stylers: [{ color: "#dfd2ae" }],
          },
          {
            featureType: "poi",
            elementType: "labels.text.fill",
            stylers: [{ color: "#93817c" }],
          },
          {
            featureType: "poi.park",
            elementType: "geometry.fill",
            stylers: [{ color: "#a5b076" }],
          },
          {
            featureType: "poi.park",
            elementType: "labels.text.fill",
            stylers: [{ color: "#447530" }],
          },
          {
            featureType: "road",
            elementType: "geometry",
            stylers: [{ color: "#f5f1e6" }],
          },
          {
            featureType: "road.arterial",
            elementType: "geometry",
            stylers: [{ color: "#fdfcf8" }],
          },
          {
            featureType: "road.highway",
            elementType: "geometry",
            stylers: [{ color: "#f8c967" }],
          },
          {
            featureType: "road.highway",
            elementType: "geometry.stroke",
            stylers: [{ color: "#e9bc62" }],
          },
          {
            featureType: "road.highway.controlled_access",
            elementType: "geometry",
            stylers: [{ color: "#e98d58" }],
          },
          {
            featureType: "road.highway.controlled_access",
            elementType: "geometry.stroke",
            stylers: [{ color: "#db8555" }],
          },
          {
            featureType: "road.local",
            elementType: "labels.text.fill",
            stylers: [{ color: "#806b63" }],
          },
          {
            featureType: "transit.line",
            elementType: "geometry",
            stylers: [{ color: "#dfd2ae" }],
          },
          {
            featureType: "transit.line",
            elementType: "labels.text.fill",
            stylers: [{ color: "#8f7d77" }],
          },
          {
            featureType: "transit.line",
            elementType: "labels.text.stroke",
            stylers: [{ color: "#ebe3cd" }],
          },
          {
            featureType: "transit.station",
            elementType: "geometry",
            stylers: [{ color: "#dfd2ae" }],
          },
          {
            featureType: "water",
            elementType: "geometry.fill",
            stylers: [{ color: "#b9d3c2" }],
          },
          {
            featureType: "water",
            elementType: "labels.text.fill",
            stylers: [{ color: "#92998d" }],
          },
        ],
      });
      loadDumps();
    }

    async function loadDumps() {
      const snapshot = await db.collection("dumps").get();
      snapshot.forEach((doc) => {
        const data = doc.data();
        // TEMP: For MVP, use geocoding later. For now, just show pins at default center.
        const marker = new google.maps.Marker({
          position: { lat: 37.7749, lng: -122.4194 },
          map,
          title: data.address,
          icon: data.status === "open"
            ? "http://maps.google.com/mapfiles/ms/icons/green-dot.png"
            : "http://maps.google.com/mapfiles/ms/icons/red-dot.png",
        });

        const infoWindow = new google.maps.InfoWindow({
          content: `
            <strong>${data.address}</strong><br>
            <span class="badge ${data.status === 'open' ? 'badge-open' : 'badge-closed'}">${data.status.toUpperCase()}</span> • ${data.cost}<br>
            <em>${data.notes || "No notes"}</em>
          `,
        });

        marker.addListener("click", () => {
          infoWindow.open(map, marker);
        });
      });
    }

    document.getElementById("submitForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      try {
        await db.collection("dumps").add({
          address: document.getElementById("address").value,
          status: document.getElementById("status").value,
          cost: document.getElementById("cost").value,
          notes: document.getElementById("notes").value || "",
          timestamp: firebase.firestore.FieldValue.serverTimestamp(),
        });
        alert("✅ Thank you! Your submission helps the RV community.");
        document.getElementById("submitForm").reset();
      } catch (error) {
        alert("❌ Error submitting. Please try again.");
        console.error(error);
      }
    });
  </script>

  <!-- ADSENSE AUTO ADS (PASTE YOUR CODE HERE AFTER APPROVAL) -->
  <!-- <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXX" crossorigin="anonymous"></script> -->

</body>
</html>
